%---------------------------------------------------------------------
\section{MRAC direto ($n^* = 1$)}

O controle adaptativo de modelo de referência (MRAC) é um método de controle
adaptativo com uma fundação teórica rigorosa e sistemática, possui promissora e
atraente perspectiva de aplicação, e seu projeto é simples e conciso. O objetivo
do MRAC é garantir que a resposta de saída de um sistema controlado (planta) convirja para a
resposta de um modelo de referência, dado que a planta possui parâmetros desconhecidos.
Isto é feito através de uma lei de adaptação dos parâmetros do controlador que garante a estabilidade 
do sistema em malha fechada e a \textit{limitação} dos parâmetros estimados.

Considere um sistema linear invariante no tempo descrito pela equação
diferencial:% (Eq. \ref{eq:planta}):
%
\begin{equation}
P(s) \, [y(t)] = Z(s) \, [u(t)],
\label{eq:planta}
\end{equation}

onde $y(t) \in \mathbb{R}$ e $u(t) \in \mathbb{R}$ são os sinais medidos de
saída e entrada do sistema, sendo:
%
\begin{gather}
P(s) = s^n + p_{n-1}s^{n-1}+\ldots + p_1s+p_0\,,\\
Z(s) = z_ms^m + z_{m-1}s^{m-1}+\ldots + z_1s+z_0 \,,
\label{eq:poly}
\end{gather}
%
os polinômios em $s$, com $s$ sendo o operador de diferencial
$s[x(t)]=\dot{x}(t)$. $p_i$, $i = 0,1,\ldots,n-1$ e $z_i$, $i=0,1,\ldots,m$ ($n>m$) são os parâmetros desconhecidos da planta.


Dado um modelo de referência descrito como:
%
\begin{equation}
P_m(s)[y_m](t) = r(t),
\end{equation}
%
onde $P_m(s)$ é um polinômio estável mônico e $r(t)$ é a entrada de referência
limitada, o objetivo do controle é encontrar uma lei de controle $u(t)$ tal que todo o sistema de malha
fechada produza sinais limitados e a saída da planta $y(t)$ rastreie assintoticamente o modelo de referência $y_m(t)$. A estrutura exige algumas premissas:
\begin{enumerate}
  \item $Z(s)$ é um polinômio estável (a planta é de fase mínima);
  \item O sinal de $k_p$ é conhecido;
  \item O grau relativo da planta é conhecido, e no caso deste trabalho, é igual a um ($n^* = 1$);
  \item A ordem da planta ($n$) é conhecida.
	\item O modelo de referencia é dado por uma função de transferência $P_m(s)$ que é SPR.
\end{enumerate}

A estrutura do controlador é 2DOF, como pode ser visto na figura
\ref{mrac}. Escolhe-se então um polinômio do observador $A_0(s)$ de modo que se obtenha um polinômio estável $\Lambda(s) =
s^n+\lambda_{n-1}s^{n-1}+\ldots+\lambda_1s+\lambda_0$ para filtrar a entrada e a
saída da planta com o filtro $\frac{1}{\Lambda(s)}$. A equação do controlador
é descrita como:
\begin{equation}
u(t) = \theta_1^\intercal\omega_1(t)+\theta_2^\intercal\omega_2(t)+\theta_n
y(t)+ \theta_{2n} r(t),
\end{equation}

onde o filtro é descrito pela realização de estados:
%
\begin{gather}
\dot{\omega}_1(t) = A_\lambda \, \omega_1(t) + bu(t)\,,\\
\dot{\omega}_2(t) = A_\lambda \, \omega_2(t) + by(t)\,,
\label{eq:statespace}
\end{gather}
%
onde $\omega_1(t) \in \mathbb{R}^n$, $\omega_2(t) \in \mathbb{R}^n$ e:
%
\begin{equation}
A_\lambda = 
\begin{bmatrix}
    0      & 1      & 0      & \dots  & 0      & 0      \\
    0      & 0      & 1      & 0      & \dots  & 0      \\
    \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
    0      & 0      & \dots  & \dots  & 0      & 1      \\
    -\lambda_0 & -\lambda_1 & \dots & \dots & -\lambda_{n-2} & -\lambda_{n-1} 
\end{bmatrix}
\in \mathbb{R}^{n \times n} \,, \quad b =
\begin{bmatrix}
    0  \\
    \vdots  \\
    0 \\
    1 \\ 
\end{bmatrix}
\in \mathbb{R}^n \,.
\label{eq:statespace}
\end{equation}

\begin{figure}[H]
  \centering
  \includegraphics[width=15cm]{figs/mrac.pdf}
  \caption{Estrutura MRAC.}
  \label{mrac} 
\end{figure}

Os valores ideais para o controle $\theta^*$ são obtidos pelo procedimento descrito no trabalho 4, dados os parâmetros da planta conhecidos. Como não é
o caso, consideramos $\theta$ como uma estimativa dos parâmetros ideais e
formulamos a seguinte lei de controle:
%
\begin{gather}
u(t) = \theta^\intercal\omega, \\
\omega(t) = \left[\omega_1(t)^\intercal \quad y(t) \quad \omega_2(t)^\intercal
\quad r(t)\right]^\intercal, \\
\theta = \left[\theta_1 \quad \theta_n \quad \theta_2 \quad \theta_{2n}\right]
\end{gather}

Definindo o erro de saída como $e(t) = y(t) - y_m(t)$, é possível demonstrar por
Lyapunov que, variando $\theta$ através da lei de adaptação:
%
\begin{equation}
\dot{\theta}(t) = -\textrm{sign}[k_p] \, \Gamma \, \omega(t) \, e(t),
\end{equation}
%
o erro converge assintoticamente para zero, em que $\Gamma =
\Gamma^\intercal > 0$ é uma matriz de ganhos positiva definida.

Neste trabalho, serão consideradas plantas de segunda e terceira ordens com grau
relativo 1 ($n^*=1$). Iremos simular e discutir o comportamento do erro e das
saídas para variações das condições iniciais dos parâmetros estimados
($\theta(0)$) e da planta ($y(0)$), do ganho de adaptação $\Gamma$ e para
diferentes parâmetros da planta e modelo.
